from toil.job import Job
import subprocess


def HaplotypeCallerERC(job, GATK, RefFasta, RefIndex, RefDict, sampleName, bamFile, bamIndex, ):
    command0 = 'java'
    command1 = '-jar'
    command2 = GATK
    command3 = '-T'
    command4 = 'HaplotypeCaller'
    command5 = '-ERC'
    command6 = 'GVCF'
    command7 = '-R'
    command8 = RefFasta
    command9 = '-I'
    command10 = bamFile
    command11 = '-o'
    command12 = sampleName + '_rawLikelihoods.g.vcf'

    subprocess.check_call([command0, command1, command2, command3, command4, command5, command6, command7, command8, command9, command10, command11, command12, ])
    job.fileStore.logToMaster('HaplotypeCallerERC')



def GenotypeGVCFs(job, GATK, RefFasta, RefIndex, RefDict, sampleName, GVCFs, ):
    command13 = 'java'
    command14 = '-jar'
    command15 = GATK
    command16 = '-T'
    command17 = 'GenotypeGVCFs'
    command18 = '-R'
    command19 = RefFasta
    command20 = '-V'
    command21 = GVCFs
    command22 = '-o'
    command23 = sampleName + '_rawVariants.vcf'

    subprocess.check_call([command13, command14, command15, command16, command17, command18, command19, command20, command21, command22, command23, ])
    job.fileStore.logToMaster('GenotypeGVCFs')




if __name__=="__main__":
    options = Job.Runner.getDefaultOptions("./toilWorkflowRun")
    options.logLevel = "INFO"
    Job.Runner.startToil(job0, options)
